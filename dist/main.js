!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("react"));else if("function"==typeof define&&define.amd)define(["react"],t);else{var n="object"==typeof exports?t(require("react")):t(e.React);for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}("undefined"!=typeof self?self:this,function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(t,n){t.exports=e},function(e,t,n){e.exports=n(2)()},function(e,t,n){"use strict";var r=n(3);function o(){}function u(){}u.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,u,a){if(a!==r){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:u,resetWarningCache:o};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),u=n(1),a=n.n(u),i=Object(r.createContext)(),c=function(e){var t=e.reducer,n=e.initialState,u=e.children;return console.log("StateContextProvider updated"),o.a.createElement(i.Provider,{value:Object(r.useReducer)(t,n)},u)};c.propTypes={children:a.a.node.isRequired,initialState:a.a.shape({}).isRequired,reducer:a.a.func.isRequired};var s=function(){return Object(r.useContext)(i)};function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(e){var t={queries:new Map};return o.a.createElement(c,{initialState:t,reducer:function(e,t){switch(t.type){case"updateQueries":var n=e.queries;return n.set(t.key,t.value),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){l(e,t,n[t])})}return e}({},e,{queries:n});default:return e}}},o.a.createElement("h4",null,"COmposant principal"),o.a.createElement("div",{style:{border:"red 2px solid"}},e.children))},p=function(e,t){return t=t||{},new Promise(function(n,r){var o=new XMLHttpRequest,u=[],a=[],i={},c=function(){return{ok:2==(o.status/100|0),statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(JSON.parse(o.responseText))},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:c,headers:{keys:function(){return u},entries:function(){return a},get:function(e){return i[e.toLowerCase()]},has:function(e){return e.toLowerCase()in i}}}};for(var s in o.open(t.method||"get",e,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(e,t,n){u.push(t=t.toLowerCase()),a.push([t,n]),i[t]=i[t]?i[t]+","+n:n}),n(c())},o.onerror=r,o.withCredentials="include"==t.credentials,t.headers)o.setRequestHeader(s,t.headers[s]);o.send(t.body||null)})};function d(e,t,n,r,o,u,a){try{var i=e[u](a),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}var y="FIXME";function v(e){return new Promise(function(){var t,n=(t=regeneratorRuntime.mark(function t(n,r){var o,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p("".concat(y,"/_msearch"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-ndjson"},body:"{}\n".concat(JSON.stringify(e),"\n")});case 2:return o=t.sent,t.next=5,o.json();case 5:u=t.sent,n(u);case 7:case"end":return t.stop()}},t)}),function(){var e=this,n=arguments;return new Promise(function(r,o){var u=t.apply(e,n);function a(e){d(u,r,o,a,i,"next",e)}function i(e){d(u,r,o,a,i,"throw",e)}a(void 0)})});return function(e,t){return n.apply(this,arguments)}}())}function m(e){return{bool:{must:0===e.size?{match_all:{}}:Array.from(e.values())}}}function h(e,t){var n,r,o,u=[];for(var a in e)for(var i in t)u.push({term:(n={},r=e[a],o=t[i],r in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,n)});return u}var b=function(e){var t=e.onChange,n=e.total,r=e.itemsPerPage,u=e.currentPage,a=[],i=Math.min(Math.floor(n/r),1e4/r);return(a=u<5?[1,2,3,4,5,i]:u>=5&&u<=i-4?[1,u-2,u-1,u,u+1,u+2,i]:[1,i-4,i-3,i-2,i-1,i]).filter(function(e){return e<=i}),o.a.createElement("ul",null,a.map(function(e){return o.a.createElement("li",{key:e},o.a.createElement("button",{onClick:function(){return t(e)}},e))}))};function g(e,t,n,r,o,u,a){try{var i=e[u](a),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,u=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,u=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw u}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var w=function(e){var t=e.size,n=O(s(),1)[0].queries,u=O(Object(r.useState)([]),2),a=u[0],i=u[1],c=O(Object(r.useState)(0),2),l=c[0],f=c[1],p=O(Object(r.useState)(1),2),d=p[0],y=p[1],h=m(n);return t=t||10,Object(r.useEffect)(function(){function e(){var n;return n=regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v({query:h,size:t,from:(d-1)*t});case 2:n=e.sent,i(n.responses[0].hits.hits),f(n.responses[0].hits.total);case 5:case"end":return e.stop()}},e)}),(e=function(){var e=this,t=arguments;return new Promise(function(r,o){var u=n.apply(e,t);function a(e){g(u,r,o,a,i,"next",e)}function i(e){g(u,r,o,a,i,"throw",e)}a(void 0)})}).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[JSON.stringify(h),d]),o.a.createElement("div",{style:{border:"green 2px solid",margin:"10px"}},o.a.createElement("h5",null,"Résultats : ",l),a.map(function(e){return o.a.createElement("div",{key:e._source.REF},"Résultat n°",e._source.TICO)}),o.a.createElement(b,{onChange:function(e){return y(e)},total:l,itemsPerPage:t,currentPage:d}))};function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,u=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,u=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw u}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var j=function(e){var t=e.customQuery,n=e.id,u=x(s(),2),a=u[0].queries,i=u[1],c=x(Object(r.useState)(),2),l=c[0],f=c[1];return o.a.createElement("div",{style:{border:"blue 2px solid",margin:"10px"}},o.a.createElement("h5",null,"Componsant recherche"),o.a.createElement("input",{type:"text",value:l,onChange:function(e){f(e.target.value),i({type:"updateQueries",key:n,value:t(e.target.value)})}}),o.a.createElement("div",null,"Internal query: ",JSON.stringify(a.get(n))))};function P(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){E(e,t,n[t])})}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t,n,r,o,u,a){try{var i=e[u](a),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,u=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,u=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw u}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var T=function(e){var t=e.fields,n=e.id,u=R(s(),2),a=u[0].queries,i=u[1],c=R(Object(r.useState)([]),2),l=c[0],f=c[1],p=R(Object(r.useState)(""),2),d=p[0],y=p[1],b=R(Object(r.useState)(5),2),g=b[0],O=b[1],w=R(Object(r.useState)([]),2),x=w[0],j=w[1];return Object(r.useEffect)(function(){function e(){var r;return r=regeneratorRuntime.mark(function e(){var r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(){var e,r={};return t.forEach(function(e){var t,n;r=S({},r,(n={field:t=e,order:{_count:"desc"},size:g},d&&(n.include=".*".concat(d,".*")),E({},t,{terms:n})))}),{query:m((e=new Map(a),e.delete(n),e)),size:0,aggs:r}},e.next=3,v(r());case 3:o=e.sent,f(o.responses[0].aggregations[t[0]].buckets);case 5:case"end":return e.stop()}},e)}),(e=function(){var e=this,t=arguments;return new Promise(function(n,o){var u=r.apply(e,t);function a(e){k(u,n,o,a,i,"next",e)}function i(e){k(u,n,o,a,i,"throw",e)}a(void 0)})}).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[d,g,JSON.stringify(m(a))]),o.a.createElement("div",{style:{border:"orange 2px solid",margin:"10px"}},o.a.createElement("h5",null,"Facette"),o.a.createElement("input",{value:d,placeholder:"Filter facet",onChange:function(e){y(e.target.value)}}),l.map(function(e){return o.a.createElement("label",{key:e.key},o.a.createElement("br",null),o.a.createElement("input",{type:"checkbox",checked:x.includes(e.key),onChange:function(r){var o=r.target.checked?P(new Set([].concat(P(x),[e.key]))):x.filter(function(t){return t.key===e.key});j(o),i({type:"updateQueries",key:n,value:{bool:{should:h(t,o)}}})}}),e.key," (",e.doc_count,")")}),l.length===g?o.a.createElement("button",{onClick:function(){return O(g+5)}},"Voir plus"):null,o.a.createElement("div",null,"Internal query: ",JSON.stringify(a.get(n))))};n.d(t,"Elasticsearch",function(){return f}),n.d(t,"Results",function(){return w}),n.d(t,"SearchBox",function(){return j}),n.d(t,"Facet",function(){return T}),n.d(t,"Pagination",function(){return b})}])});